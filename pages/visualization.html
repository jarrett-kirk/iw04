<!DOCTYPE html>
<html>
    <head>
        <link
            rel="stylesheet"
            type="text/css"
            href="{{ url_for('static', filename='stylesheets/main.css') }}"
        />
        <meta name="viewport" content="width=device-width,initial-scale=1.0" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    </head>
    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                <polygon points="0,0 5,5 0,10" fill="#EE4B2B" />
            </marker>
        </defs>
        <symbol id="arrow-right">
            <path d="M0,25 L50,25" fill="none" stroke="#EE4B2B" stroke-width="2" marker-end="url(#arrowhead)" />
        </symbol>
        <symbol id="arrow-up">
            <path d="M25,50 L25,0" fill="none" stroke="#EE4B2B" stroke-width="2" marker-end="url(#arrowhead)" />
        </symbol>
        <symbol id="arrow-up-bottom">
            <path d="M0,48 L50,48 M25,48 L25,0" fill="none" stroke="#EE4B2B" stroke-width="2" marker-end="url(#arrowhead)" />
        </symbol>
        <symbol id="line-bottom">
            <path d="M0,48 L50,48" fill="none" stroke="#EE4B2B" stroke-width="2" />
        </symbol>
        <symbol id="arrow-flowchart">
            <path d="M0,25 L25,25 L25,125 L50,125" fill="none" stroke="#EE4B2B" stroke-width="2" marker-end="url(#arrowhead)" />
        </symbol>
    </svg>
    {% include "./header.html" %}
    <div class="main-container">
        <div style="align-items: right;">
            <h2 style="align-self: left;">What is a Galois LFSR?</h2>
            <p>A Galois Linear Feedback Shift Register is a psuedo-random number generator, or in other words, it creates a number that appears random. This is process has two main components: "bits" and "taps". First, we start with a random sequence of bits, in this visualization, 8 bits. Next, we randomly choose our taps. These taps are postioned along the 8-bit sequence and do not change during the process. Now, with these two things, we can preform a "step". First, the last bit is sent out and becomes a part of the output. Next, all the bits are shifted to the right, and the first bit becomes the output bit. Here is where the taps come in. For any position along the sequence that has a tap, that position will be XORed with the output bit after the shift. In this visualization, arrows are provided to make following this process easier. If two arrows going into an "X", those values are XORed together.</p>
        </div>

        <!------------------------- LFSR STUFF -------------------------->
        <div class="lfsr">

            <div class="column-container">
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2,50 L2,25 L50,25" fill="none" stroke="#EE4B2B" stroke-width="2" marker-end="url(#arrowhead)" />
                    </svg>
                </div>
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2,50 L2,0" fill="none" stroke="#EE4B2B" stroke-width="2" />
                    </svg>
                </div>
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2,50 L2,0" fill="none" stroke="#EE4B2B" stroke-width="2" />
                    </svg>
                </div>
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2,48 L50,48 M2,48 L2,0" fill="none" stroke="#EE4B2B" stroke-width="2" />
                    </svg>
                </div>
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit0" onclick="changeBit(0)"></button>
                </div>
                <div class="small-container"></div>
                <div class="small-container"></div>
                <div class="small-container">
                    <svg><use href="#line-bottom"/></svg>
                </div>
            </div>

            <div class="column-container" id="tap0-arrows0">
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit1" onclick="changeBit(1)"></button>
                </div>
                <div class="small-container" id="tap0-arrows1"></div>
                <div class="small-container">
                    <button class="tap-button" id="tap0" onclick="changeTap(0)"></button>
                </div>
                <div class="small-container" id="tap0-arrows2"></div>
            </div>

            <div class="column-container" id="tap1-arrows0">
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit2" onclick="changeBit(2)"></button>
                </div>
                <div class="small-container" id="tap1-arrows1"></div>
                <div class="small-container">
                    <button class="tap-button" id="tap1" onclick="changeTap(1)"></button>
                </div>
                <div class="small-container" id="tap1-arrows2"></div>
            </div>

            <div class="column-container" id="tap2-arrows0">
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit3" onclick="changeBit(3)"></button>
                </div>
                <div class="small-container" id="tap2-arrows1"></div>
                <div class="small-container">
                    <button class="tap-button" id="tap2" onclick="changeTap(2)"></button>
                </div>
                <div class="small-container" id="tap2-arrows2"></div>
            </div>

            <div class="column-container" id="tap3-arrows0">
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit4" onclick="changeBit(4)"></button>
                </div>
                <div class="small-container" id="tap3-arrows1"></div>
                <div class="small-container">
                    <button class="tap-button" id="tap3" onclick="changeTap(3)"></button>
                </div>
                <div class="small-container" id="tap3-arrows2"></div>
            </div>

            <div class="column-container" id="tap4-arrows0">
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit5" onclick="changeBit(5)"></button>
                </div>
                <div class="small-container" id="tap4-arrows1"></div>
                <div class="small-container">
                    <button class="tap-button" id="tap4" onclick="changeTap(4)"></button>
                </div>
                <div class="small-container" id="tap4-arrows2"></div>
            </div>

            <div class="column-container" id="tap5-arrows0">
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit6" onclick="changeBit(6)"></button>
                </div>
                <div class="small-container" id="tap5-arrows1"></div>
                <div class="small-container">
                    <button class="tap-button" id="tap5" onclick="changeTap(5)"></button>
                </div>
                <div class="small-container" id="tap5-arrows2"></div>
            </div>

            <div class="column-container" id="tap6-arrows0">
            </div>

            <div class="column-container">
                <div class="small-container">
                    <button class="bit-button" id="bit7" onclick="changeBit(7)"></button>
                </div>
                <div class="small-container" id="tap6-arrows1"></div>
                <div class="small-container">
                    <button class="tap-button" id="tap6" onclick="changeTap(6)"></button>
                </div>
                <div class="small-container" id="tap6-arrows2"></div>
            </div>

            <div class="column-container">
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0,25 L48,25 L48,50" fill="none" stroke="#EE4B2B" stroke-width="2" />
                    </svg>
                </div>
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M48,0 L48,50" fill="none" stroke="#EE4B2B" stroke-width="2" />
                    </svg>
                </div>
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M48,0 L48,50" fill="none" stroke="#EE4B2B" stroke-width="2" />
                    </svg>
                </div>
                <div class="small-container">
                    <svg class="arrow-svg" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M48,0 L48,48 M0,48 L48,48" fill="none" stroke="#EE4B2B" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>
        <!------------------------- LFSR STUFF -------------------------->

        <div style="align-items: right;">
            <h2 style="align-self: left;">How Do I use the Visualization?</h2>
            <p>Click on a bit or a tap to change its state. Click "Next" to advance the Galois LFSR one state. You can refresh the page to reset the ouptut bits. Beside the "Submit" button, you can fill in the next LFSR state and it will tell you if you were right or wrong.</p>
        </div>
        <button class="next-button" onclick="step()" style="justify-self: right;">Next</button>
        <p id="output-bits" style="font-size: larger;">Ouput: </p>

        <form id="vis-form">
            <textarea id="visanswer"></textarea>
            <button class="next-button" type="submit">Submit</button>
        </form>
        <p id="output"></p>
    <script src='./static/script/lfsr.js'></script>
</html>
